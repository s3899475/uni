Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2023-04-30T21:10:39+10:00

====== Week 5 ======
Contents:
* [[#Part 1 - Layer 3 and IP Services|Part 1 - Layer 3 and IP Services]]
* [[#Part 2 - Subnets|Part 2 - Subnets]]
* [[#Part 3 - NAT, PAT and DHCP|Part 3 - NAT, PAT and DHCP]]
* [[#Part 4 - IP route summarization|Part 4 - IP route summarization]]


===== Part 1 - Layer 3 and IP Services =====
Functions:
* Unique addressing for many devices to intercommunicate
* Routing protocols to build the L3 forwarding table
* Finds a path for end-to-end delivery of application data
Devices:
* Routes
Protocols:
* IP

Layer 3 connects multiple Layer 2 networks

==== Overview: ====
* Connection-less
* Packet fragmentation and reassembly
* QoS
* Max packet size is 65,636 bytes
* 2 main versions, IPv4, IPv6

==== Global addressing ====
global addressing provided by IANA
delegates to Regional Internet Registries (RIRs)
RIRs allocate address space to ISPs
Address assignments in RFC 1466
2 types of assigned addresses:
* public
* private - used in private networks

=== RIRs: ===
* AfriNIC - africa
* APNIC - asia & oceania
* ARIN - north america
* LACNIC - south america
* RIPE NCC - europe

=== Private address blocks: ===
* 10.0.0.0	to 10.255.255.255
* 172.0.0.0	to 172.255.255.255
* 192.168.0.0	to 192.168.255.255
* 169.254.0.0	to 169.254.255.255 for automatic private IP addressing

private addresses should not be used to send or receive traffic from others on the internet
networks using private addresses can perform network address translation (NAT) to map private addresses to public ones

=== IP packet header ===
{{./pasted_image.png?width=600}}
fields:
* **IHL (IP Header Length)** - 4 bits for the number of 32 bit words in the header. Usually 5
* **TOS (Type of Service)** - 8 bits for a 6 bit Differentiated Services Code Point (DSCP) and a 2 bit Explicit Congestion Notification (ECN)
* **Total Length** - 16 bits for the total length of the packet
* **Identification** - 16 bits to uniquely identify the packet. Used along side the source address
* **Flags** - 3 bits for Don't Fragment (DF) flag and whether the packet is the last fragment (More Fragment (MF) flag)
* **Fragment Offset** - offset from start of original packet
* **Time To Live (TTL)** - Number of hops or links that the packet may be routed over
* **Protocol** - 8 bits for the type of packet (1 = ICMP, 2 = IGMP, 6 = TCP, 17 = UDP)
* **Header Checksum**
* **Source IP Address**
* **Destination IP Address**
* **Options** - not often used
* **Padding** - ensures header ends on a 32-bit boundary when options are used

==== Address types ====
Unicast - one device
Broadcast - all devices in the broadcast domain
	Highest address in the subnet
Multicast - a group of devices
	Uses addresses 224.0.0.0 to 239.255.255.255
Anycast - used when one IP address refers to multiple hosts (devices)
	packets sent to the nearest host or service


===== Part 2 - Subnets =====
==== Classless Interdomain Routing (CIDR) ====
no address classes
size of network and host components is not fixed
uses subnet mask to identify the network and host

IP addressing scheme is heirarchical
two level:
network and host component

==== Subnets ====
subnet mask - all one bits at start, all zero at end

subnets are created by borrowing bits from the host component
each subnet provides fewer hosts
subnets should not overlap

**Summarization**
- a single network prefix (IP) can represent multiple subnets

=== VLSM (Variable Length Subnet Masking) ===
divides network into subnets of various sizes

subnet mask
number of bits used for the network
boolean and can be used to extract the network  component and the host component

The first address (host all 0 bits) is the network address
The last address (host all 1s) is the broadcast address

=== Special Subnet Masks ===
[[/31]]
* no broadcast or network address, only 2 host addresses
* Ideal for point-to-point links
[[/32]]
* No broadcast or network address. Only one host address that represents the network
* System address must be a [[/32]] address, loopback addresses can be associated to any subnet mask range

==== System address ====
Special type of loopback address
used to reach the router itself
like a loopback address - is not associated with any port
system interface is defined by default, but does not have an address
Always has a [[/32]] prefix value

===== Part 3 - NAT, PAT and DHCP =====
==== Home/Buissiness network ====
Default gateway - provides access from home network to the internet
home networks usually use private addresses

=== NAT - Network Address Translation ===
one-to-one address translation, using NAT Table
can translate private to public

=== PAT - Port Address Translation ===
many-to-one address translation
one port for one address
uses transport layer port numbers (TCP ports, etc.)
also called Network Address Port Translation (NAPT)

home routers require public IP address - requested from the ISP. Typically dynamic, or can be static

==== DHCP (Dynamic Host Control Protocol) ====
Dynamic IP address assigned to devices
not a permanent address - addresses can be released

==== ICMP (Internet Control Message Protocol) ====
Used to report errors in delivering IP packets (error messages such as destination unreachable)
Also used for diagnostic purposes (ICMP query messages such as echo - used for ping)
Is a type of packet
different versions for IPv4 - ICMPv4 and IPv6 - ICMPv6
RFC 792 and RFC 1122

==== ARP - Address Resolution Protocol ====
resolves an Ethernet MAC address for a given IP address
Required within a single broadcast Ethernet LAN
ARP messages do not cross the local network boundary
RFC 826 and RFC 1122

Arp request process:
* One host sends a message to the broadcast address:
	* Who has (IP)
* The host that has the IP  will reply with its MAC address
* Then the first host will add it to its ARP cache

== ARP requests include the **IP address and MAC address** of the host that sent it ==
If any other hosts don't have the sending host's MAC address in their ARP cache, it will be added.

=== ARP and ICMP with a router ===
when a host needs to ping another host in a remote network:
* source host will send an ARP to the gateway router to discover its MAC address
* router will reply with MAC address
* source will add the address to its ARP cache
* source will send an ICMP echo to the gateway router with the IP address set as the destination host's address, but the MAC address will be the router's
* router will broadcast ARP in the destination network, asking for the MAC address of the destination host
* destination host will reply with its MAC address
* router will add the address to its ARP cache
* router will forward ICMP echo to destination
* destination will respond, with the destination set as the source host, but the MAC address of the router
* Router will forward the reply to the source host

===== Part 4 - IP route summarization =====

